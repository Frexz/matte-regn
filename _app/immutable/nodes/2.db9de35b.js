import{s as safe_not_equal,n as noop,r as run_all}from"../chunks/scheduler.e108d1fd.js";import{S as SvelteComponent,i as init,g as element,s as space,m as text,h as claim_element,j as children,c as claim_space,f as detach,n as claim_text,k as attr,l as set_style,a as insert_hydration,x as append_hydration,y as set_input_value,z as listen,A as to_number,o as set_data,B as destroy_each}from"../chunks/index.04c859ae.js";function ensure_array_like(t){return(t==null?void 0:t.length)!==void 0?t:Array.from(t)}const _page_svelte_svelte_type_style_lang="";function get_each_context(t,e,l){const p=t.slice();return p[20]=e[l],p}function create_each_block(t){let e,l=t[20].problem+"",p;return{c(){e=element("p"),p=text(l),this.h()},l(s){e=claim_element(s,"P",{style:!0,class:!0});var o=children(e);p=claim_text(o,l),o.forEach(detach),this.h()},h(){set_style(e,"color",t[20].color),set_style(e,"left",t[20].x+"px"),set_style(e,"top",t[20].y+"px"),attr(e,"class","svelte-m2xrap")},m(s,o){insert_hydration(s,e,o),append_hydration(e,p)},p(s,o){o&4&&l!==(l=s[20].problem+"")&&set_data(p,l),o&4&&set_style(e,"color",s[20].color),o&4&&set_style(e,"left",s[20].x+"px"),o&4&&set_style(e,"top",s[20].y+"px")},d(s){s&&detach(e)}}}function create_fragment(t){let e,l,p,s,o,c,_,m,f,u,v,y,h=ensure_array_like(t[2]),r=[];for(let n=0;n<h.length;n+=1)r[n]=create_each_block(get_each_context(t,h,n));return{c(){e=element("div"),l=element("div");for(let n=0;n<r.length;n+=1)r[n].c();p=space(),s=element("hr"),o=space(),c=element("input"),_=space(),m=element("h1"),f=text("Poeng: "),u=text(t[0]),this.h()},l(n){e=claim_element(n,"DIV",{class:!0,style:!0});var i=children(e);l=claim_element(i,"DIV",{class:!0});var a=children(l);for(let g=0;g<r.length;g+=1)r[g].l(a);p=claim_space(a),s=claim_element(a,"HR",{class:!0}),a.forEach(detach),o=claim_space(i),c=claim_element(i,"INPUT",{class:!0,type:!0}),_=claim_space(i),m=claim_element(i,"H1",{});var d=children(m);f=claim_text(d,"Poeng: "),u=claim_text(d,t[0]),d.forEach(detach),i.forEach(detach),this.h()},h(){attr(s,"class","svelte-m2xrap"),attr(l,"class","game-window svelte-m2xrap"),attr(c,"class","game-input svelte-m2xrap"),attr(c,"type","number"),c.autofocus=!0,attr(e,"class","content svelte-m2xrap"),set_style(e,"--width",WIDTH+"px"),set_style(e,"--height",HEIGHT+"px")},m(n,i){insert_hydration(n,e,i),append_hydration(e,l);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(l,null);append_hydration(l,p),append_hydration(l,s),append_hydration(e,o),append_hydration(e,c),set_input_value(c,t[1]),append_hydration(e,_),append_hydration(e,m),append_hydration(m,f),append_hydration(m,u),c.focus(),v||(y=[listen(c,"keypress",t[5]),listen(c,"input",t[6])],v=!0)},p(n,[i]){if(i&4){h=ensure_array_like(n[2]);let a;for(a=0;a<h.length;a+=1){const d=get_each_context(n,h,a);r[a]?r[a].p(d,i):(r[a]=create_each_block(d),r[a].c(),r[a].m(l,p))}for(;a<r.length;a+=1)r[a].d(1);r.length=h.length}i&2&&to_number(c.value)!==n[1]&&set_input_value(c,n[1]),i&1&&set_data(u,n[0])},i:noop,o:noop,d(n){n&&detach(e),destroy_each(r,n),v=!1,run_all(y)}}}const WIDTH=1200,HEIGHT=500,ADDITION_LANE=100,SUBTRACTION_LANE=400,MULTIPLICATION_LANE=700,DIVISION_LANE=1e3;let animationSpeed=10;function instance($$self,$$props,$$invalidate){let timer=0,moveLength=.5,rate=300,interval,answer,poeng=0,gameStarted=!1,speedIncrease=!1,rateIncrease=!1,problemInfo={0:{operator:"+",color:"#FFB3B3",x:ADDITION_LANE},1:{operator:"-",color:"#90C8AC",x:SUBTRACTION_LANE},2:{operator:"*",color:"#EEE4AB",x:MULTIPLICATION_LANE},3:{operator:"/",color:"#8CC0DE",x:DIVISION_LANE}},problems=[];function startGame(){$$invalidate(2,problems=[]),moveLength=.5,$$invalidate(0,poeng=0),rate=300,interval=setInterval(()=>{checkGameOver(),checkSpeedIncreaseAndRate(),generateProblem(),moveProblems(),timer++},animationSpeed)}function moveProblems(){for(const t of problems)t.y+=moveLength;$$invalidate(2,problems)}function checkGameOver(){for(const t of problems)t.y>HEIGHT-50+3&&(clearInterval(interval),$$invalidate(4,gameStarted=!1))}function handleKeypress(t){t.keyCode==13&&!gameStarted?$$invalidate(4,gameStarted=!0):t.keyCode==13&&(checkAnswer(answer),$$invalidate(1,answer=""))}function checkAnswer(t){problems.forEach(e=>{e.answer==t&&$$invalidate(0,poeng++,poeng)}),$$invalidate(2,problems=problems.filter(e=>e.answer!=t))}function checkSpeedIncreaseAndRate(t){speedIncrease&&(moveLength+=.1,speedIncrease=!1),rateIncrease&&(rate-=30,rateIncrease=!1)}function generateProblem(){if(timer%rate==0){let typeNumber=Math.floor(4*Math.random()),num1=Math.floor(10*Math.random()),num2=Math.floor(10*Math.random());for(;typeNumber==1&&num1<num2;)num1=Math.floor(10*Math.random()),num2=Math.floor(10*Math.random());for(;typeNumber==3&&(num1<num2||num1%num2!=0||num2==0);)num1=Math.floor(10*Math.random()),num2=Math.floor(10*Math.random());let problem=num1.toString()+" "+problemInfo[typeNumber].operator+" "+num2.toString();problems.push({problem,answer:eval(problem),color:problemInfo[typeNumber].color,x:problemInfo[typeNumber].x,y:0})}}const keypress_handler=t=>handleKeypress(t);function input_input_handler(){answer=to_number(this.value),$$invalidate(1,answer)}return $$self.$$.update=()=>{$$self.$$.dirty&16&&gameStarted&&startGame(),$$self.$$.dirty&1&&(poeng%5==0&&poeng>0&&(speedIncrease=!0),poeng%10==0&&poeng>0&&(rateIncrease=!0))},[poeng,answer,problems,handleKeypress,gameStarted,keypress_handler,input_input_handler]}class Page extends SvelteComponent{constructor(e){super(),init(this,e,instance,create_fragment,safe_not_equal,{})}}export{Page as component};
